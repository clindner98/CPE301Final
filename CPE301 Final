#include "DHT.h"

#define DHTTYPE DHT11
#define DHTPIN 12

DHT dht(DHTPIN, DHTTYPE);

int fan =13;
int power = 2;
float temp;
float hum;
int powerStateCurrent = 0;
int powerStateLast;
int fanState = 0;
int error = 5;
int on = 6;
int off = 4;


void setup() {
  // put your setup code here, to run once:
pinMode(fan, OUTPUT);
pinMode(power, INPUT);

Serial.begin(9600);
Serial.println("Current Room Temperature:");

dht.begin();
}

void loop() {
  // put your main code here, to run repeatedly:
  temp = dht.readTemperature();
  hum = dht.readHumidity();
  if(isnan(temp) || isnan(hum)){
   Serial.println("Error");
   digitalWrite(error, HIGH);
   digitalWrite(on, LOW);
   digitalWrite(off, LOW);
   return;
  }

  Serial.println(temp);
  
  powerStateLast = powerStateCurrent;
  powerStateCurrent = digitalRead(power);
if(powerStateCurrent == HIGH && powerStateLast == LOW){
  Serial.println(powerStateCurrent);
  fanState = !fanState;
  digitalWrite(fan, fanState);
  digitalWrite(on, fanState);
  digitalWrite(off, !fanState);
  digitalWrite(error, LOW);
  
}
}


